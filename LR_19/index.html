<!DOCTYPE html>
<html>
<head>
	<title></title>
	<style>
        table {
            border-collapse: collapse;
            margin: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 10px;
        }
        th {
            background-color: lightgray;
        }
        .pagination {
            display: flex;
            justify-content: center;
            margin: 20px;
        }
        .page {
            margin: 0 10px;
        }
        .active {
            font-weight: bold;
        }
    </style>
</head>
<body>
	<input type="text" id="PULPIT" placeholder="PULPIT">
	<input type="text" id="PULPIT_NAME" placeholder="PULPIT_NAME">
	<input type="text" id="FACULTY" placeholder="FACULTY">
	<button onclick="Get_pulpits()" >GET</button>
	<button onclick="Post_pulpits()" >POST</button>
	<button onclick="Put_pulpits()" >PUT</button>
	<button onclick="Delete_pulpits()" >DELETE</button>

	<div id="result_get">
		<table id="departmentsTable">
			<thead>
				<tr>
					<th>PULPIT</th>
					<th>PULPIT_NAME</th>
					<th>FACULTY</th>
					<th>Count</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
		<div class="pagination" id="pagination">
		</div>
	</div>
	<div id="result_post"></div>
	<div id="result_put"></div>
	<div id="result_delete"></div>
	<script type="text/javascript">
		Get_pulpits();
		async	function Get_pulpits(){
			let response = await fetch("http://localhost:3000/api/pulpitshtml");
			if(response.ok){
				result="";
				let departments=await response.json();
				const table = document.getElementById("departmentsTable").getElementsByTagName('tbody')[0];
                const pagination = document.getElementById("pagination");

// Количество записей на странице
const recordsPerPage = 10;

// Общее количество страниц
const totalPages = Math.ceil(departments.length / recordsPerPage);

// Функция для отображения страницы
function showPage(page) {
    // Определяем начало и конец вывода записей на странице
    const start = (page - 1) * recordsPerPage;
    const end = start + recordsPerPage;

    // Очищаем таблицу
    table.innerHTML = "";
    
    // Выводим записи на странице
    for (let i = start; i < end && i < departments.length; i++) {
        const department = departments[i];
        const row = table.insertRow();
        const PULPIT = row.insertCell();
        const PULPIT_NAME = row.insertCell();
		const FACULTY = row.insertCell();
		const COUNT = row.insertCell();
        PULPIT.innerHTML = department.PULPIT;
        PULPIT_NAME.innerHTML = department.PULPIT_NAME;
		FACULTY.innerHTML = department.FACULTY;
		COUNT.innerHTML = department._count.TEACHER_TEACHER_PULPITToPULPIT;
    }

    // Отображаем пагинацию
    pagination.innerHTML = "";
    for (let i = 1; i <= totalPages; i++) {
        const pageButton = document.createElement("button");
        pageButton.classList.add("page");
        if (i === page) {
            pageButton.classList.add("active");
        }
        pageButton.innerText = i;
        pageButton.onclick = function() {
            showPage(i);
        }
        pagination.appendChild(pageButton);
    }
}

// Отображаем первую страницу
showPage(1);
			
			}
		};
		async	function Post_pulpits() {
			send=JSON.stringify({"PULPIT":document.getElementById("PULPIT").value
				,"PULPIT_NAME":document.getElementById("PULPIT_NAME").value,"FACULTY":document.getElementById("FACULTY").value});
		
			let response = await fetch("http://localhost:3000/api/pulpits",{
				method:"POST",
				headers:{"Content-Type":"application/json"},
				body:send
			});
			if(response.ok){
				
				let json=await response.text();
				document.getElementById("result_post").innerHTML+="iserting";
			}else{
				let json=await response.json();
				document.getElementById("result_post").innerHTML="result_post:"+json["ERROR"];
			}
		}
		async	function Put_pulpits() {
			send=JSON.stringify({"PULPIT":document.getElementById("PULPIT").value
				,"PULPIT_NAME":document.getElementById("PULPIT_NAME").value,"FACULTY":document.getElementById("FACULTY").value});
			let response = await fetch("http://localhost:3000/api/pulpits",{
				method:"PUT",
				headers:{"Content-Type":"application/json"},
				body:send
			});
			if(response.ok){
				
				let json=await response.text();
				document.getElementById("result_put").innerHTML+="Updating";
			}else{
				let json=await response.json();
				document.getElementById("result_put").innerHTML="result_put:"+json["ERROR"];
			}
		}
		async	function Delete_pulpits() {
			url="http://localhost:3000/api/pulpits/"+document.getElementById("PULPIT").value;
			let response = await fetch(url,{
				method:"DELETE"
			});
			if(response.ok){
				
				let json=await response.text();
				document.getElementById("result_delete").innerHTML+="Deleting";
			}else{
				let json=await response.json();
				document.getElementById("result_delete").innerHTML="result_delete:"+json["ERROR"];
			}
		}
  // функция для отображения списка кафедр на основе номера страницы
  function showDepartments(page) {
        // получаем элементы списка кафедр и кнопок пагинации
        var departmentList = document.getElementById("department-list");
        var paginationButtons = document.getElementById("pagination-buttons");
        // вычисляем начальный и конечный индексы кафедр на странице
        var startIndex = (page - 1) * 10;
        var endIndex = startIndex + 9;
        // получаем все кафедры и считаем их количество
        var departments = departmentList.getElementsByTagName("li");
        var numDepartments = departments.length;
        // перебираем кафедры и скрываем или отображаем их в зависимости от номера страницы
        for (var i = 0; i < numDepartments; i++) {
          if (i >= startIndex && i <= endIndex) {
            departments[i].style.display = "block";
          } else {
            departments[i].style.display = "none";
          }
        }
        // обновляем кнопки пагинации, чтобы подсветить текущую страницу
        var buttons = paginationButtons.getElementsByTagName("button");
        var numButtons = buttons.length;
        for (var j = 0; j < numButtons; j++) {
          if (j + 1 == page) {
            buttons[j].classList.add("active");
          } else {
            buttons[j].classList.remove("active");
          }
        }
      }
	</script>
</body>
</html>