<!DOCTYPE html>
<html>
<head>
    <title>List customers</title>
    <meta charset="utf-8" />
</head>
<body>
    <h1><a href="http://localhost:3000/html/customer/">List Customers</a></h1>
     <table>
         <tr><th>CustomerID</th><th>CompanyName</th><th>Abbreviation</th></tr>
         {{#each customers}}
            <tr><td>{{this.customer_id}}</td><td>{{this.company_name}}</td><td>{{this.abbreviation}}</td></tr>
         {{/each}}
     </table>

     <h1>Find Customer</h1>
      <table>
         <tr><th>CustomerID</th><th>CompanyName</th><th>Abbreviation</th></tr>
         {{#each find_customers}}
            <tr><td>{{this.customer_id}}</td><td>{{this.company_name}}</td><td>{{this.abbreviation}}</td></tr>
         {{/each}}
     </table>
        <label>CompanyName</label>
        <input type="text" name="company_name" id="findName" /><br><br>
        <input type="submit" onclick="findCust()" value="Find Customer" />

     <h1>Add Customer</h1>
        <label>CompanyName</label>
        <input type="text" name="company_name" id="company_name" /><br><br>
        <label>Abbreviation</label>
        <input type="text" name="abbreviation" id="abbreviation"/><br><br>
        <input type="submit" onclick="addCust()" value="Add Customer" />
     
     <h1>Update Customer</h1>
     {{!-- <form action="../customer?_method=PUT" method="POST"> --}}
        <label>CompanyID</label>
        <input type="number" name="customer_id" id="updID" /><br><br>
        <label>CompanyName</label>
        <input type="text" name="company_name" id="updName" /><br><br>
        <label>Abbreviation</label>
        <input type="text" name="abbreviation" id="updAbbr"/><br><br>
        <input type="submit" onclick="updCust()" value="Update Customer" />
     {{!-- </form> --}}
     
     <h1>Delete Customer</h1>
        <label>CompanyID</label>
        <input id="customer_id" type="number" name="customer_id" /><br><br>
        <input type="submit" onClick="deleteCust()" value="Delete Customer" />


     <script>
         addCust = () => {
            let company_name = document.getElementById("company_name").value;
            let abbreviation = document.getElementById("abbreviation").value;
            let bodyData = {
               company_name: company_name,
               abbreviation: abbreviation
            }
            console.log(`Data: ${bodyData}`);
            fetch(`http://localhost:3000/customer`, {
                method: 'POST',
                headers: {'Content-Type' : 'application/json'},
                body: JSON.stringify(bodyData)
            });
            setTimeout(() => { window.location.reload(); }, 500);
         }
         
         findCust = () => {
            let company_name = document.getElementById("findName").value;
            window.location.href = `http://localhost:3000/customer/${company_name}`;
         }
         
         updCust = () => {
            let customer_id = document.getElementById("updID").value;
            let company_name = document.getElementById("updName").value;
            let abbreviation = document.getElementById("updAbbr").value;
            let bodyData = {
               customer_id: customer_id,
               company_name: company_name,
               abbreviation: abbreviation
            }
            console.log(`Data: ${bodyData}`);
            fetch(`http://localhost:3000/customer`, {
                method: 'PUT',
                headers: {'Content-Type' : 'application/json'},
                body: JSON.stringify(bodyData)
            });
            setTimeout(() => { window.location.reload(); }, 500);
         }

        deleteCust = () => {
            let ID = document.getElementById("customer_id").value;
            console.log(ID);
            fetch(`http://localhost:3000/customer/${ID}`, {
                method: 'DELETE',
            });
            setTimeout(() => { window.location.reload(); }, 500);
        }
     </script>
</body>
<html>